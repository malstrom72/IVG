# ivgfont

## Table of Contents

- [Overview](#overview)
- [Why a new font format?](#why-a-new-font-format)
- [File structure](#file-structure)
    - [Header](#header)
    - [Metrics](#metrics)
    - [Glyphs](#glyphs)
    - [Kerning](#kerning)
- [Converting fonts](#converting-fonts)
- [Example](#example)

## Overview

_ivgfont_ is a compact text-based format for vector fonts.  Each file is an
ImpD script that describes font metrics, glyph outlines and optional kerning
pairs using the same primitives as IVG images.

## Why a new font format?

Standard OpenType and TrueType fonts contain many features that the IVG engine
does not need, and parsing those formats requires large third‑party
libraries.  _ivgfont_ keeps only the essentials—glyph paths, advance widths,
metrics and kerning—so fonts can be embedded directly in IVG documents
without external dependencies.

## File structure

An _ivgfont_ file is an ImpD document beginning with a format line followed by
instructions that describe the font.

### Header

    format ivgfont-1 requires:IMPD-1

### Metrics

The `metrics` instruction defines the font’s global measurements.

    metrics upm:<units-per-em> ascent:<ascent> descent:<descent> linegap:<linegap>

### Glyphs

Each glyph is defined with a `glyph` instruction that maps a character to its
advance width and SVG path data.

    glyph <character> <x-advance> <path>

The path string uses standard SVG path commands.  Files generated by the
tools often assign `g=glyph` and then invoke `$g` to shorten the output, but
the shorthand is optional.

### Kerning

Optional kerning adjustments are expressed with the `kern` instruction.  A
single adjustment may specify multiple left/right clusters.

    kern <adjustment> <left> <right> [<left> <right>] ...

### Converting fonts

Use the `IVGFontConverter` tool to convert an OpenType or TrueType font to
_ivgfont_.

```
node tools/IVGFontConverter/IVGFontConverter.node.js <font-file> [ ? | - | <feature>[,<feature>...] ] [ <charset>[,<charset>] ] > output.ivgfont
```

- `?` lists available GSUB features.
- `-` disables extra features.
- `<feature>` enables specific GSUB features.
- `<charset>` restricts the converted Unicode range (hex values or ranges).

By default the converter outputs the ISO Latin‑1 character set.

## Example

```
format ivgfont-1 requires:IMPD-1
metrics upm:1000 ascent:1036 descent:-335 linegap:0
glyph I 371 m136-617-92-11v-41h283v41l-92,11-2,128v308l2,129,92,11V0H44v-41l92-11q2-63,2-128v-308q0-65-2-129z
glyph V 674 m90-619-75-9v-41h273v45l-96,9,168,479,162-478-88-10v-45h231v41l-87,12L367,7h-44L90-619z
glyph G 682 m384,15q-100,0-176-45-76-46-119-125-42-79-42-180t43-179q43-79,119-124,77-46,179-46,62,0,110,12,49,11,91,35l4,146h-62l-20-114q-52-29-114-29-69,0-124,35-54,35-86,102-31,66-31,162,0,143,66,221t181,78q57,0,107-20v-32l-1-90-1-91-104-9v-40h263v40l-61,6-2,91v137Q552-17,499-1T384,15z
kern -70 V G
```

This snippet defines three glyphs and a kerning pair for `V` followed by `G`.
